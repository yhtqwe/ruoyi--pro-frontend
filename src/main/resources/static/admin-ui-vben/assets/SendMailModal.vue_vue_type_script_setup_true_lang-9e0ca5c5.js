import{b as k,k as l,s as x}from"./template-06ea2902.js";import{a as P,B as C}from"./index-ab29420a.js";import{u as R,_ as $}from"./useForm-2cb760a4.js";import"./BasicForm.vue_vue_type_style_index_0_lang-da06c4a7.js";import{d as v,o as V,j as K,w as L,n as O,k as t,af as j,y as E}from"./index-2b36f9e3.js";const W=v({name:"SendMailModal",__name:"SendMailModal",setup(I){const[d,{setFieldsValue:m,getFieldsValue:p,validateFields:u,resetFields:f,clearValidate:h,appendSchemaByField:y,removeSchemaByField:g}]=R({labelWidth:120,schemas:k,baseColProps:{span:24},showActionButtonGroup:!1});let o=[];const[_,{changeLoading:w,changeOkLoading:M,closeModal:F}]=P(async e=>{await r();const s=[];e.params.forEach(a=>{const n=l+a,i={field:n,label:`参数{${a}} `,component:"Input",componentProps:{placeholder:`输入{${a}}`},required:!0};s.push(i),o.push(n)}),m(e),y(s,void 0)});function c(e){M(e),w(e)}async function S(){await g(o),o=[]}const{createMessage:b}=E();async function B(){try{c(!0),await u();const e=p(),s={mail:e.mail,templateCode:e.code,templateParams:{}};Object.keys(e).forEach(a=>{if(["mail","code","content"].includes(a))return;const i=a.split(l)[1];s.templateParams[i]=e[a]}),await x(s),b.success(`发送邮件到[${e.mail}]成功`),F()}catch{}finally{c(!1)}}async function r(){await S(),await f(),await h()}return(e,s)=>(V(),K(t(C),j(e.$attrs,{title:"发送邮件",width:"600px",onRegister:t(_),onOk:B,onCancel:r}),{default:L(()=>[O(t($),{onRegister:t(d)},null,8,["onRegister"])]),_:1},16,["onRegister"]))}});export{W as _};
