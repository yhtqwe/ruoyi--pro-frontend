import{L as s,d as _,c as y,r as w,k as t,o as x,j as P,w as C,n as M,af as O,y as A}from"./index-84bac5b8.js";import"./index-1beb4355.js";import"./BasicForm.vue_vue_type_style_index_0_lang-f40c69bb.js";import{a as R,B as U}from"./index-173d5d49.js";import"./sortable.esm-f208c0d8.js";import{u as n}from"./useRender-70a86cea.js";import{D as r,g as c}from"./dict-5c702769.js";import{u as k,_ as q}from"./useForm-9e126d4c.js";const H=[{title:"客户端编号",dataIndex:"clientId",width:200},{title:"客户端密钥",dataIndex:"secret",width:100},{title:"应用名",dataIndex:"name",width:100},{title:"应用图标",dataIndex:"logo",width:120,customRender:({text:e})=>n.renderImg(e)},{title:"状态",dataIndex:"status",width:180,customRender:({text:e})=>n.renderDict(e,r.COMMON_STATUS)},{title:"访问令牌的有效期",dataIndex:"accessTokenValiditySeconds",width:100,customRender:({text:e})=>n.renderText(e,"秒")},{title:"刷新令牌的有效期",dataIndex:"refreshTokenValiditySeconds",width:100,customRender:({text:e})=>n.renderText(e,"秒")},{title:"授权类型",dataIndex:"authorizedGrantTypes",width:180,customRender:({text:e})=>n.renderTags(e)},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>n.renderDate(e)}],j=[{label:"应用名",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:c(r.COMMON_STATUS)},colProps:{span:8}}],V=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"客户端编号",field:"clientId",required:!0,component:"Input"},{label:"客户端密钥",field:"secret",required:!0,component:"Input"},{label:"应用名",field:"name",required:!0,component:"Input"},{label:"应用图标",field:"logo",required:!0,component:"FileUpload",componentProps:{fileType:"image",maxCount:1}},{label:"应用描述",field:"description",component:"InputTextArea"},{label:"状态",field:"status",component:"Select",componentProps:{options:c(r.COMMON_STATUS)}},{label:"访问令牌的有效期",field:"accessTokenValiditySeconds",required:!0,defaultValue:0,component:"InputNumber"},{label:"刷新令牌的有效期",field:"refreshTokenValiditySeconds",required:!0,defaultValue:0,component:"InputNumber"},{label:"授权类型",field:"authorizedGrantTypes",required:!0,component:"Select",componentProps:{options:c(r.SYSTEM_OAUTH2_GRANT_TYPE,"string"),mode:"multiple"}},{label:"授权范围",field:"scopes",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"自动授权范围",field:"autoApproveScopes",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"可重定向的 URI 地址",field:"redirectUris",required:!0,component:"Select",componentProps:{mode:"tags",options:[]}},{label:"权限",field:"authorities",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"资源",field:"resourceIds",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"附加信息",field:"additionalInformation",component:"InputTextArea"}];function W(e){return s.get({url:"/system/oauth2-client/page",params:e})}function N(e){return s.get({url:`/system/oauth2-client/get?id=${e}`})}function v(e){return s.post({url:"/system/oauth2-client/create",data:e})}function F(e){return s.put({url:"/system/oauth2-client/update",data:e})}function J(e){return s.delete({url:`/system/oauth2-client/delete?id=${e}`})}const K=_({name:"SystemClientModal",__name:"ClientModal",emits:["success","register"],setup(e,{emit:u}){const p=u,{t:i}=y(),{createMessage:m}=A(),a=w(!0),[f,{setFieldsValue:g,resetFields:h,validate:I}]=k({labelWidth:160,baseColProps:{span:24},schemas:V,showActionButtonGroup:!1,actionColOptions:{span:23}}),[S,{setModalProps:l,closeModal:T}]=R(async o=>{if(h(),l({confirmLoading:!1}),a.value=!!o?.isUpdate,t(a)){const d=await N(o.record.id);g({...d})}});async function b(){try{const o=await I();l({confirmLoading:!0}),t(a)?await F(o):await v(o),T(),p("success"),m.success(i("common.saveSuccessText"))}finally{l({confirmLoading:!1})}}return(o,d)=>(x(),P(t(U),O(o.$attrs,{title:a.value?t(i)("action.edit"):t(i)("action.create"),onRegister:t(S),onOk:b}),{default:C(()=>[M(t(q),{onRegister:t(f)},null,8,["onRegister"])]),_:1},16,["title","onRegister"]))}});export{K as _,H as c,J as d,W as g,j as s};
