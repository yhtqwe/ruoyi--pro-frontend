import{b as B,s as F}from"./index-3b06acc3.js";import{a as P,B as $}from"./index-ab29420a.js";import{u as v,_ as w}from"./useForm-2cb760a4.js";import"./BasicForm.vue_vue_type_style_index_0_lang-da06c4a7.js";import{d as y,B as C,r as R,o as V,j as k,w as j,n as x,k as n,af as E,y as I}from"./index-2b36f9e3.js";const N=y({name:"SendSmsModal",__name:"SendSmsModal",setup(O){const{createMessage:i}=I(),a=C([]),r=R(""),[m,{setFieldsValue:d,getFieldsValue:p,validateFields:u,resetFields:f,clearValidate:h,setProps:l}]=v({labelWidth:100,baseColProps:{span:24},showActionButtonGroup:!1}),[b,{changeLoading:c,closeModal:g}]=P(e=>{S(),e.params.forEach(o=>{const M={field:`key-${o}`,label:`参数{${o}} `,component:"Input",componentProps:{placeholder:`输入{${o}}`},required:!0};a.push(M)});const{content:t,code:s}=e;d({content:t}),r.value=s});async function _(){try{l({disabled:!0}),c(!0),await u();const e=p(),t={mobile:e.mobile,templateCode:r.value,templateParams:{}};Object.keys(e).forEach(s=>{if(s==="content"||s==="mobile")return;const o=s.split("-")[1];t.templateParams[o]=e[s]}),await F(t),i.success(`发送短信到[${e.mobile}]成功`),g()}finally{l({disabled:!1}),c(!1)}}function S(){a.splice(0,a.length),a.push(...B),f(),h()}return(e,t)=>(V(),k(n($),E(e.$attrs,{title:"测试发送短信",onRegister:n(b),onOk:_}),{default:j(()=>[x(n(w),{schemas:a,onRegister:n(m)},null,8,["schemas","onRegister"])]),_:1},16,["onRegister"]))}});export{N as _};
