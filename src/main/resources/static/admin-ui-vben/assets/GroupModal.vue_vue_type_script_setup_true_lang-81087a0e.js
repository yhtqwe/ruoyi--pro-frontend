import{L as n,d as S,c as T,r as P,k as t,o as R,j as x,w as G,n as O,af as C,y as k}from"./index-2b36f9e3.js";import"./index-238a0b12.js";import"./BasicForm.vue_vue_type_style_index_0_lang-da06c4a7.js";import{a as F,B as v}from"./index-ab29420a.js";import"./sortable.esm-f208c0d8.js";import{u as l}from"./useRender-e7048bde.js";import{D as p,g as m}from"./dict-d92cc9bc.js";import{g as f}from"./index-0efdcaab.js";import{u as y,_ as B}from"./useForm-2cb760a4.js";let g=[];async function L(){g=await f()}await L();const K=[{title:"编号",dataIndex:"id",width:100},{title:"组名",dataIndex:"name",width:180},{title:"描述",dataIndex:"description",width:200},{title:"成员",dataIndex:"memberUserIds",width:180,customRender:({record:e,text:c})=>{const a=[];if(c){for(const o of e.memberUserIds){let i=!1;g.forEach(s=>{o===s.id&&(a.push(s.nickname),i=!0)}),i||a.push(`未知(${o})`)}return l.renderTags(a)}}},{title:"状态",dataIndex:"status",width:180,customRender:({text:e})=>l.renderDict(e,p.COMMON_STATUS)},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>l.renderDate(e)}],Q=[{label:"组名",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:m(p.COMMON_STATUS)},colProps:{span:8}},{label:"创建时间",field:"createTime",component:"RangePicker",colProps:{span:8}}],A=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"组名",field:"name",required:!0,component:"Input"},{label:"描述",field:"description",required:!0,component:"Input"},{label:"成员",field:"memberUserIds",required:!0,component:"ApiTransfer",componentProps:{api:()=>f(),showSearch:!0,labelField:"nickname",valueField:"id"}},{label:"状态",field:"status",component:"RadioGroup",componentProps:{options:m(p.COMMON_STATUS)}}];function D(e){return n.post({url:"/bpm/user-group/create",data:e})}function $(e){return n.put({url:"/bpm/user-group/update",data:e})}function X(e){return n.delete({url:`/bpm/user-group/delete?id=${e}`})}function N(e){return n.get({url:`/bpm/user-group/get?id=${e}`})}function Z(e){return n.get({url:"/bpm/user-group/page",params:e})}const ee=S({name:"BpmGroupModal",__name:"GroupModal",emits:["success","register"],setup(e,{emit:c}){const a=c,{t:o}=T(),{createMessage:i}=k(),s=P(!0),[h,{setFieldsValue:b,resetFields:w,validate:I}]=y({labelWidth:120,baseColProps:{span:24},schemas:A,showActionButtonGroup:!1,actionColOptions:{span:23}}),[U,{setModalProps:u,closeModal:_}]=F(async r=>{if(w(),u({confirmLoading:!1}),s.value=!!r?.isUpdate,t(s)){const d=await N(r.record.id);b({...d})}});async function M(){try{const r=await I();u({confirmLoading:!0}),t(s)?await $(r):await D(r),_(),a("success"),i.success(o("common.saveSuccessText"))}finally{u({confirmLoading:!1})}}return(r,d)=>(R(),x(t(v),C(r.$attrs,{title:s.value?t(o)("action.edit"):t(o)("action.create"),onRegister:t(U),onOk:M}),{default:G(()=>[O(t(B),{onRegister:t(h)},null,8,["onRegister"])]),_:1},16,["title","onRegister"]))}});export{ee as _,K as c,X as d,Z as g,Q as s};
