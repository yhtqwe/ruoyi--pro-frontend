import{b as B,s as F}from"./template-bfd48f0f.js";import{a as P,B as S}from"./index-ab29420a.js";import{u as v,_ as w}from"./useForm-2cb760a4.js";import"./BasicForm.vue_vue_type_style_index_0_lang-da06c4a7.js";import{d as C,B as I,r as R,o as $,j as N,w as V,n as k,k as r,af as j,y as x}from"./index-2b36f9e3.js";const L=C({name:"SendNotifyModal",__name:"SendNotifyModal",setup(E){const{createMessage:i}=x(),a=I([]),n=R(""),[d,{setFieldsValue:u,getFieldsValue:m,validateFields:p,resetFields:f,clearValidate:h,setProps:c}]=v({labelWidth:100,baseColProps:{span:24},showActionButtonGroup:!1}),[g,{changeLoading:l,closeModal:_}]=P(e=>{y(),e.params.forEach(o=>{const M={field:`key-${o}`,label:`参数{${o}} `,component:"Input",componentProps:{placeholder:`输入{${o}}`},required:!0};a.push(M)});const{content:t,code:s}=e;u({content:t}),n.value=s});async function b(){try{c({disabled:!0}),l(!0),await p();const e=m(),t={userId:e.userId,templateCode:n.value,templateParams:{}};Object.keys(e).forEach(s=>{if(s==="content"||s==="userId")return;const o=s.split("-")[1];t.templateParams[o]=e[s]}),await F(t),i.success("发送站内信成功"),_()}finally{c({disabled:!1}),l(!1)}}function y(){a.splice(0,a.length),a.push(...B),f(),h()}return(e,t)=>($(),N(r(S),j(e.$attrs,{title:"发送站内信",onRegister:r(g),onOk:b}),{default:V(()=>[k(r(w),{schemas:a,onRegister:r(d)},null,8,["schemas","onRegister"])]),_:1},16,["onRegister"]))}});export{L as _};
