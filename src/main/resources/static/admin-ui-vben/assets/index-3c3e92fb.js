import{b as p}from"./index-70ebb9ee.js";import{L as c,d as h,c as g,v as x,G as I,o as s,h as E,n as w,w as a,D as b,j as P,k as i,I as R,x as y,t as D,y as M}from"./index-84bac5b8.js";import"./index-1beb4355.js";import"./BasicForm.vue_vue_type_style_index_0_lang-f40c69bb.js";import"./index-173d5d49.js";import"./sortable.esm-f208c0d8.js";import{u as r}from"./useRender-70a86cea.js";import{D as o,g as m}from"./dict-5c702769.js";import{_ as C}from"./BasicTable.vue_vue_type_script_setup_true_lang-6c55bad0.js";import{u as v}from"./useTable-2040b40a.js";import"./index-f29e621a.js";import"./index-b9509bee.js";import"./index-2dea95e5.js";import"./index-d2cf1d1c.js";import"./DownOutlined-a8fe79f2.js";import"./isMobile-174ba801.js";import"./index-d4092c42.js";import"./List-9fcea96e.js";import"./CheckOutlined-c0652f6b.js";import"./index-9bf8eb9e.js";import"./eagerComputed-aaf02481.js";import"./index-343834d4.js";import"./fromPairs-e099444b.js";import"./index-81d4b3c0.js";import"./DoubleRightOutlined-1bb4c7eb.js";import"./useBreakpoint-8b027837.js";import"./responsiveObserve-85850b10.js";import"./zh_CN-1ca40490.js";import"./tree-a6f36781.js";import"./debounce-51e23acd.js";import"./scrollTo-b5e908bd.js";import"./operationUnit-d5166b83.js";import"./index-cc732a41.js";import"./index-831ed906.js";import"./index-3e1b457d.js";import"./get-acbb0bab.js";import"./index-09793f90.js";import"./Col-5c991ea4.js";import"./useFlexGapSupport-7bccf8d7.js";import"./_baseIteratee-de9a7973.js";import"./onMountedOrActivated-78e848f5.js";import"./PlusOutlined-c3a73197.js";import"./index-5d2832e9.js";import"./index-7a2ca6fc.js";import"./copyTextToClipboard-cc995e2b.js";import"./index-723fd4c3.js";import"./useWindowSizeFn-edf59fbd.js";import"./FullscreenOutlined-2d9cb280.js";import"./RedoOutlined-c04dd14b.js";import"./useForm-9e126d4c.js";import"./uniqBy-966a1ca5.js";import"./index-9785aad3.js";let l=[];async function k(){l=await p()}await k();const Y=[{title:"日志编号",dataIndex:"id",width:100},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>r.renderDate(e)},{title:"手机号",dataIndex:"mobile",width:180,customRender:({text:e,record:t})=>t.userType&&t.userId?r.renderDict(t.userType,o.USER_TYPE):e},{title:"短信内容",dataIndex:"templateContent",width:300},{title:"发送状态",dataIndex:"sendStatus",width:180,customRender:({text:e})=>r.renderDict(e,o.SYSTEM_SMS_SEND_STATUS)},{title:"接收状态",dataIndex:"receiveStatus",width:180,customRender:({text:e})=>r.renderDict(e,o.SYSTEM_SMS_RECEIVE_STATUS)},{title:"短信渠道",dataIndex:"channelCode",width:180,customRender:({text:e,record:t})=>{if(!e)return"未设置";for(const n of l)if(t.channelId===n.id)return n.signature;return`找不到签名：${t.channelId}`}},{title:"模板编号",dataIndex:"templateId",width:120},{title:"短信类型",dataIndex:"templateType",width:180,customRender:({text:e})=>r.renderDict(e,o.SYSTEM_SMS_TEMPLATE_TYPE)}],A=[{label:"手机号",field:"mobile",component:"Input",colProps:{span:8}},{label:"短信渠道",field:"channelId",component:"ApiSelect",componentProps:{api:p,fieldNames:{label:"signature",key:"id",value:"id"}},colProps:{span:8}},{label:"模板编号",field:"templateId",component:"Input",colProps:{span:8}},{label:"发送状态",field:"sendStatus",component:"Select",componentProps:{options:m(o.SYSTEM_SMS_SEND_STATUS)},colProps:{span:8}},{label:"发送时间",field:"sendTime",component:"RangePicker",colProps:{span:8}},{label:"接收状态",field:"receiveStatus",component:"Select",componentProps:{options:m(o.SYSTEM_SMS_RECEIVE_STATUS)},colProps:{span:8}},{label:"接收时间",field:"receiveTime",component:"RangePicker",colProps:{span:8}}];function L(e){return c.get({url:"/system/sms-log/page",params:e})}function N(e){return c.download({url:"/system/sms-log/export",params:e},"短信日志.xls")}const Ue=h({name:"SystemSmsLog",__name:"index",setup(e){const{t}=g(),{createConfirm:n,createMessage:d}=M(),[u,{getForm:S}]=v({title:"短信日志列表",api:L,columns:Y,formConfig:{labelWidth:120,schemas:A},useSearchForm:!0,showTableSetting:!0,showIndexColumn:!1});async function _(){n({title:t("common.exportTitle"),iconType:"warning",content:t("common.exportMessage"),async onOk(){await N(S().getFieldsValue()),d.success(t("common.exportSuccessText"))}})}return(U,V)=>{const f=x("a-button"),T=I("auth");return s(),E("div",null,[w(i(C),{onRegister:i(u)},{toolbar:a(()=>[b((s(),P(f,{"pre-icon":i(R).EXPORT,onClick:_},{default:a(()=>[y(D(i(t)("action.export")),1)]),_:1},8,["pre-icon"])),[[T,["system:sms-log:export"]]])]),_:1},8,["onRegister"])])}}});export{Ue as default};
