import{L as n,d as _,c as R,r as P,k as o,o as C,j as A,w as k,n as q,af as x,y}from"./index-2b36f9e3.js";import"./index-238a0b12.js";import"./BasicForm.vue_vue_type_style_index_0_lang-da06c4a7.js";import{a as M,B as T}from"./index-ab29420a.js";import"./sortable.esm-f208c0d8.js";import{u as f}from"./useRender-e7048bde.js";import{D as a,g as u}from"./dict-d92cc9bc.js";import{u as E,_ as L}from"./useForm-2cb760a4.js";const H=[{title:"编号",dataIndex:"id",width:100},{title:"配置名",dataIndex:"name",width:180},{title:"存储器",dataIndex:"storage",width:100,customRender:({text:e})=>f.renderDict(e,a.INFRA_FILE_STORAGE)},{title:"主配置",dataIndex:"master",width:180,customRender:({text:e})=>f.renderDict(e,a.INFRA_BOOLEAN_STRING)},{title:"备注",dataIndex:"remark",width:180},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>f.renderDate(e)}],Y=[{label:"配置名",field:"name",component:"Input",colProps:{span:8}},{label:"存储器",field:"storage",component:"Select",componentProps:{options:u(a.INFRA_FILE_STORAGE)},colProps:{span:8}},{label:"创建时间",field:"createTime",component:"RangePicker",colProps:{span:8}}],O=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"配置名",field:"name",required:!0,component:"Input"},{label:"存储器",field:"storage",component:"Select",required:!0,dynamicDisabled:({values:e})=>!!e.id,componentProps:{options:u(a.INFRA_FILE_STORAGE)}},{label:"基础路径",field:"config.basePath",required:!0,ifShow:({values:e})=>e.storage>=10&&e.storage<=12,component:"Input"},{label:"主机地址",field:"config.host",required:!0,ifShow:({values:e})=>e.storage>=11&&e.storage<=12,component:"Input"},{label:"主机端口",field:"config.port",required:!0,ifShow:({values:e})=>e.storage>=11&&e.storage<=12,component:"Input"},{label:"用户名",field:"config.username",required:!0,ifShow:({values:e})=>e.storage>=11&&e.storage<=12,component:"Input"},{label:"密码",field:"config.password",required:!0,ifShow:({values:e})=>e.storage>=11&&e.storage<=12,component:"Input"},{label:"连接模式",field:"config.basePath",required:!0,ifShow:({values:e})=>e.storage===11,component:"Select",componentProps:{options:[{lable:"主动模式",key:"Active",value:"Active"},{lable:"被动模式",key:"Passive",value:"Passive"}]}},{label:"节点地址",field:"config.endpoint",required:!0,ifShow:({values:e})=>e.storage===20,component:"Input"},{label:"存储 bucket",field:"config.bucket",required:!0,ifShow:({values:e})=>e.storage===20,component:"Input"},{label:"accessKey",field:"config.accessKey",ifShow:({values:e})=>e.storage===20,component:"Input"},{label:"accessSecret",field:"config.accessSecret",ifShow:({values:e})=>e.storage===20,component:"Input"},{label:"自定义域名",field:"config.domain",required:!0,component:"Input"},{label:"备注",field:"remark",component:"InputTextArea"}];function z(e){return n.get({url:"/infra/file-config/page",params:e})}function D(e){return n.get({url:`/infra/file-config/get?id=${e}`})}function J(e){return n.put({url:`/infra/file-config/update-master?id=${e}`})}function N(e){return n.post({url:"/infra/file-config/create",data:e})}function v(e){return n.put({url:"/infra/file-config/update",data:e})}function Q(e){return n.delete({url:`/infra/file-config/delete?id=${e}`})}function X(e){return n.get({url:`/infra/file-config/test?id=${e}`})}const Z=_({name:"InfraFileConfigModal",__name:"FileConfigModal",emits:["success","register"],setup(e,{emit:d}){const p=d,{t:s}=R(),{createMessage:g}=y(),r=P(!0),[m,{setFieldsValue:I,resetFields:h,validate:b}]=E({labelWidth:120,baseColProps:{span:24},schemas:O,showActionButtonGroup:!1,actionColOptions:{span:23}}),[w,{setModalProps:c,closeModal:S}]=M(async t=>{if(h(),c({confirmLoading:!1}),r.value=!!t?.isUpdate,o(r)){const i=await D(t.record.id);I({...i})}});async function F(){try{const t=await b(),i={};for(const l in t)l.startsWith("config.")&&(i[l.substring(7)]=t[l]);t.config=i,c({confirmLoading:!0}),o(r)?await v(t):await N(t),S(),p("success"),g.success(s("common.saveSuccessText"))}finally{c({confirmLoading:!1})}}return(t,i)=>(C(),A(o(T),x(t.$attrs,{title:r.value?o(s)("action.edit"):o(s)("action.create"),onRegister:o(w),onOk:F}),{default:k(()=>[q(o(L),{onRegister:o(m)},null,8,["onRegister"])]),_:1},16,["title","onRegister"]))}});export{Z as _,H as c,Q as d,z as g,Y as s,X as t,J as u};
