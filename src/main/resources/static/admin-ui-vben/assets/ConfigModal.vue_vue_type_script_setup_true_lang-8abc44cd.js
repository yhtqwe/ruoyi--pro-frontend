import{L as o,d as M,c as S,r as h,k as t,o as w,j as x,w as T,n as y,af as O,y as P}from"./index-2b36f9e3.js";import"./index-238a0b12.js";import"./BasicForm.vue_vue_type_style_index_0_lang-da06c4a7.js";import{a as R,B as v}from"./index-ab29420a.js";import"./sortable.esm-f208c0d8.js";import{u as c}from"./useRender-e7048bde.js";import{D as l,g as B}from"./dict-d92cc9bc.js";import{u as L,_ as N}from"./useForm-2cb760a4.js";const W=[{title:"公告编号",dataIndex:"id",width:100},{title:"签到天数",dataIndex:"day",width:180,customRender:({text:e})=>c.renderTag(`第 ${e} 天`)},{title:"获得积分",dataIndex:"point",width:180},{title:"状态",dataIndex:"status",width:180,customRender:({text:e})=>c.renderDict(e,l.COMMON_STATUS)}],$=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"签到天数",field:"day",required:!0,helpMessage:"只允许设置 1-7，默认签到 7 天为一个周期",component:"InputNumber",componentProps:{max:7,min:1,precision:0}},{label:"签到分数",field:"point",required:!0,component:"InputNumber",componentProps:{precision:0}},{label:"状态",field:"status",component:"Select",componentProps:{options:B(l.COMMON_STATUS)}}];function Y(){return o.get({url:"/member/point/sign-in-config/list"})}function k(e){return o.get({url:`/member/point/sign-in-config/get?id=${e}`})}function D(e){return o.post({url:"/member/point/sign-in-config/create",data:e})}function F(e){return o.put({url:"/member/point/sign-in-config/update",data:e})}function z(e){return o.delete({url:`/member/point/sign-in-config/delete?id=${e}`})}const J=M({name:"SignInConfigModal",__name:"ConfigModal",emits:["success","register"],setup(e,{emit:u}){const d=u,{t:s}=S(),{createMessage:m}=P(),i=h(!0),[p,{setFieldsValue:f,resetFields:g,validate:I}]=L({labelWidth:120,baseColProps:{span:24},schemas:$,showActionButtonGroup:!1,actionColOptions:{span:23}}),[_,{setModalProps:a,closeModal:b}]=R(async n=>{if(g(),a({confirmLoading:!1}),i.value=!!n?.isUpdate,t(i)){const r=await k(n.record.id);f({...r})}});async function C(){try{const n=await I();a({confirmLoading:!0}),t(i)?await F(n):await D(n),b(),d("success"),m.success(s("common.saveSuccessText"))}finally{a({confirmLoading:!1})}}return(n,r)=>(w(),x(t(v),O(n.$attrs,{title:i.value?t(s)("action.edit"):t(s)("action.create"),onRegister:t(_),onOk:C}),{default:T(()=>[y(t(N),{onRegister:t(p)},null,8,["onRegister"])]),_:1},16,["title","onRegister"]))}});export{J as _,W as c,z as d,Y as g};
