import{l as b,g as y,u as I,c as _}from"./index-efb38e20.js";import{d as P,c as C,r as N,k as t,o as U,j as k,w as O,n as x,af as B,y as E}from"./index-84bac5b8.js";import"./index-1beb4355.js";import"./BasicForm.vue_vue_type_style_index_0_lang-f40c69bb.js";import{a as R,B as v}from"./index-173d5d49.js";import"./sortable.esm-f208c0d8.js";import{u as l}from"./useRender-70a86cea.js";import{D as s,g as c}from"./dict-5c702769.js";import{S as o}from"./systemEnum-a7142728.js";import{u as A,_ as q}from"./useForm-9e126d4c.js";const J=[{title:"菜单名称",dataIndex:"name",width:250,align:"left"},{title:"菜单类型",dataIndex:"type",width:80,customRender:({text:e})=>l.renderDict(e,s.SYSTEM_MENU_TYPE)},{title:"图标",dataIndex:"icon",width:60,customRender:({record:e})=>l.renderIcon(e.icon)},{title:"排序",dataIndex:"sort",width:60},{title:"权限标识",dataIndex:"permission",width:140},{title:"组件路径",dataIndex:"component",width:140},{title:"状态",dataIndex:"status",width:80,customRender:({text:e})=>l.renderDict(e,s.COMMON_STATUS)}],K=[{label:"菜单名称",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:c(s.COMMON_STATUS)},colProps:{span:8}}],D=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"上级菜单",field:"parentId",required:!0,component:"ApiTreeSelect",componentProps:{api:()=>b(),parentLabel:"主类目",fieldNames:{label:"name",key:"id",value:"id"},handleTree:"id"}},{label:"菜单类型",field:"type",required:!0,defaultValue:"0",component:"RadioButtonGroup",componentProps:{options:c(s.SYSTEM_MENU_TYPE)},colProps:{lg:24,md:24}},{label:"菜单名称",field:"name",required:!0,component:"Input"},{label:"菜单图标",field:"icon",component:"IconPicker",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"显示排序",field:"sort",required:!0,component:"InputNumber",defaultValue:0},{label:"路由地址",field:"path",required:!0,component:"Input",helpMessage:"访问的路由地址，如：`user`。如需外网地址时，则以 `http(s)://` 开头",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"权限标识",field:"permission",component:"Input",helpMessage:'Controller 方法上的权限字符，如：@PreAuthorize(`@ss.hasPermission("system:user:list")`)',ifShow:({values:e})=>e.type!==o.DIR},{label:"组件路径",field:"component",component:"Input",helpMessage:"例如：system/user/index",ifShow:({values:e})=>e.type===o.MENU},{label:"组件名称",field:"componentName",component:"Input",helpMessage:"例如：SystemUser",ifShow:({values:e})=>e.type===o.MENU},{label:"菜单状态",field:"status",required:!0,component:"RadioButtonGroup",helpMessage:"选择停用时，路由将不会出现在侧边栏，也不能被访问",componentProps:{options:c(s.COMMON_STATUS)}},{label:"显示状态",field:"visible",component:"Switch",componentProps:{checkedChildren:"显示",unCheckedChildren:"隐藏"},helpMessage:"选择隐藏时，路由将不会出现在侧边栏，但仍然可以访问",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"总是显示",field:"alwaysShow",component:"Switch",componentProps:{checkedChildren:"显示",unCheckedChildren:"隐藏"},helpMessage:"选择不是时，当该菜单只有一个子菜单时，不展示自己，直接展示子菜单",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"是否缓存",field:"keepAlive",component:"Switch",componentProps:{checkedChildren:"缓存",unCheckedChildren:"不缓存"},helpMessage:"选择缓存时，则会被 `keep-alive` 缓存，必须填写「组件名称」字段",ifShow:({values:e})=>e.type===o.MENU}],Q=P({name:"SystemMenuModal",__name:"MenuModal",emits:["success","register"],setup(e,{emit:d}){const m=d,{t:i}=C(),{createMessage:u}=E(),a=N(!0),[f,{setFieldsValue:h,resetFields:M,validate:S}]=A({labelWidth:120,baseColProps:{span:24},schemas:D,showActionButtonGroup:!1,actionColOptions:{span:23}}),[w,{setModalProps:r,closeModal:g}]=R(async n=>{if(M(),r({confirmLoading:!1}),a.value=!!n?.isUpdate,t(a)){const p=await y(n.record.id);h({...p})}});async function T(){try{const n=await S();r({confirmLoading:!0}),t(a)?await I(n):await _(n),g(),m("success"),u.success(i("common.saveSuccessText"))}finally{r({confirmLoading:!1})}}return(n,p)=>(U(),k(t(v),B(n.$attrs,{title:a.value?t(i)("action.edit"):t(i)("action.create"),onRegister:t(w),onOk:T}),{default:O(()=>[x(t(q),{onRegister:t(f)},null,8,["onRegister"])]),_:1},16,["title","onRegister"]))}});export{Q as _,J as c,K as s};
